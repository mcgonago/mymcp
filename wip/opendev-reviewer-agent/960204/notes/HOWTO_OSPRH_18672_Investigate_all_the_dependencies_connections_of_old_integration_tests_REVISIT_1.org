#+OPTIONS: ^:nil num:nil \n:t
#+TITLE: HOWTO_OSPRH_18672_Investigate_all_the_dependencies_connections_of_old_integration_tests_REVISIT_1
#+SETUPFILE: theme-readtheorg.setup

* TL;DR

This document investigates [[https://issues.redhat.com/browse/OSPRH-18672][OSPRH-18672: Investigate all the dependencies/connections of old integration tests]]

This is revisit #1 of [[https://spaces.redhat.com/spaces/~omcgonag/pages/686721547/HOWTO_OSPRH_18672_Investigate_all_the_dependencies_connections_of_old_integration_tests][HOWTO_OSPRH_18672_Investigate_all_the_dependencies_connections_of_old_integration_tests]]

* Update ticket (comment)
Add comment to [[https://issues.redhat.com/browse/OSPRH-18672][OSPRH-18672: Investigate all the dependencies/connections of old integration tests]]
: Review at https://review.opendev.org/c/openstack/horizon/+/960204

* before moving on, I made a few more changes and did another review

: X
: ipython setup.cfg
: 
: [entry_points]
: oslo.config.opts =
:     openstack_dashboard = openstack_dashboard.utils.config:list_options
:     openstack_dashboard_integration_tests = openstack_dashboard.test.integration_tests.config:list_opts    <=== removed
: # We use a custom extractor to find translatable strings in AngularJS templates.
: # See http://babel.pocoo.org/docs/messages/#referencing-extraction-methods for
: # details on how this works.
: babel.extractors =
:     angular = horizon.utils.babel_extract_angular:extract_angular

: X
: ishell openstack_dashboard/templates/horizon/_scripts.html
: 
: {% if HORIZON_CONFIG.integration_tests_support %}                           <=== where is integration_tests_support defined?
: <script src="{{ STATIC_URL }}horizon/js/horizon.selenium.js"></script>
: {% endif %}

** File: horizon/tables/base.py

: X
: ipython horizon/tables/base.py
: 
:     if settings.INTEGRATION_TESTS_SUPPORT:
:         def get_default_attrs(self):
:             attrs = super().get_default_attrs()
:             attrs.update({'data-selenium': self.name})
:             return attrs

** another review push

: cd /home/omcgonag/Work/horizon-osprh_18672

: git config core.editor "emacsclient"
: export EDITOR=emacsclient
: M-x server-start

: git remote add gerrit ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git
: git review -s
: git remote -v

: [omcgonag@omcgonag-thinkpadp16vgen1 horizon-osprh_18672]$ git remote -v
: gerrit	ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git (fetch)
: gerrit	ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git (push)
: origin	https://opendev.org/openstack/horizon.git (fetch)
: origin	https://opendev.org/openstack/horizon.git (push)

My first sequence (first review) was:

: git remote add gerrit ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git
: git review -s
: git add .
: git commit
: git review

Is this the correct sequecne for the next change(s)?
: git add .
: git commit --amend -s
: git review

** Push review

: git add .
: git commit --amend -s
: git review

: [omcgonag@omcgonag-thinkpadp16vgen1 horizon-osprh_18672]$ git review
: remote: 
: remote: Processing changes: updated: 1 (\)        
: remote: Processing changes: updated: 1 (|)        
: remote: Processing changes: refs: 1, updated: 1 (|)        
: remote: Processing changes: refs: 1, updated: 1 (|)        
: remote: Processing changes: refs: 1, updated: 1, done            
: remote: commit 347c177: warning: subject >50 characters; use shorter first paragraph        
: remote: 
: remote: SUCCESS        
: remote: 
: remote:   https://review.opendev.org/c/openstack/horizon/+/960204 Remove all dependencies/connections of old integration test code        
: remote: 
: To ssh://review.opendev.org:29418/openstack/horizon.git
:  * [new reference]       HEAD -> refs/for/master

* First set of changes

: git clone https://opendev.org/openstack/horizon.git horizon-osprh_18672
: cd horizon-osprh_18672

: git config core.editor "emacsclient"
: export EDITOR=emacsclient
: M-x server-start

** Integration Test Directories to Remove
- openstack_dashboard/test/integration_tests - The main integration test framework
- openstack_dashboard/test/selenium/integration - Selenium-based integration tests

** Remove directories
- *openstack_dashboard/test/integration_tests/*
- *openstack_dashboard/test/selenium/integration/*

: rm -f -r openstack_dashboard/test/integration_tests
: rm -f -r openstack_dashboard/test/selenium/integration

** Tox Environment Configurations
File: *tox.ini*
- Lines 80-91: *testenv:integration* environment 
- Lines 93-103: *testenv:integration-pytest* environment
: Line 102: References `{toxinidir}/openstack_dashboard/test/selenium/integration`
: Line 91: References `{toxinidir}/openstack_dashboard/test/integration_tests`

Removed
: X
: ishell tox.ini
:
: [testenv:integration]
: # Run integration tests only
: passenv =
:   DISPLAY
:   FFMPEG_INSTALLED
:   XAUTHORITY
: setenv =
:   INTEGRATION_TESTS=1
:   SELENIUM_HEADLESS=True
: commands =
:   oslo-config-generator --namespace openstack_dashboard_integration_tests
:   pytest --ds=openstack_dashboard.test.settings -v -x --junitxml="{toxinidir}/test_reports/integration_test_results.xml" --html="{toxinidir}/test_reports/integration_test_results.html" --self-contained-html {posargs:{toxinidir}/openstack_dashboard/test/integration_tests}
: 
: [testenv:integration-pytest]
: # Run pytest integration tests only
: passenv =
:   DISPLAY
:   FFMPEG_INSTALLED
:   XAUTHORITY
: setenv =
:   SELENIUM_HEADLESS=True
: commands =
:   oslo-config-generator --namespace openstack_dashboard_integration_tests
:   pytest -x -v -k "not federation" --junitxml="{toxinidir}/test_reports/integration_pytest_results.xml" --html="{toxinidir}/test_reports/integration_pytest_results.html" --self-contained-html {posargs:{toxinidir}/openstack_dashboard/test/selenium/integration}

*TODO*: *QUESTION: Hmmm.... do we need to remove these also? reference(s) to integration_tests, integration_uitest_results?*
*DONE*: Left it for now
: X
: ishell tox.ini
:
: [testenv:ui-pytest]
: # Run pytest ui tests only
: passenv =
:   DISPLAY
:   FFMPEG_INSTALLED
:   XAUTHORITY
: setenv =
:   SELENIUM_HEADLESS=True
: commands =
:   oslo-config-generator --namespace openstack_dashboard_integration_tests
:   pytest --ds=openstack_dashboard.settings -v --junitxml="{toxinidir}/test_reports/integration_uitest_results.xml" --html="{toxinidir}/test_reports/integration_uitest_results.html" --self-contained-html {posargs:{toxinidir}/openstack_dashboard/test/selenium/ui}


*TODO*: *QUESTION: what about line integration: Mark for integration tests?*
*DONE*: removed reference for now

: X
: ishell tox.ini
: [pytest]
: markers =
:   selenium: Mark for selenium tests
:   integration: Mark for integration tests   <=== removed
:   plugin_test: Mark for plugin tests
: python_files =
:   test_*.py
:   *_test.py
:   tests.py

** Update tox.ini: Remove or comment out
- *testenv:integration* section (lines 80-91)
- *testenv:integration-pytest* section (lines 93-103)
- *testenv:ui-pytest* section (lines 105-115)

** Update setup.cfg: Remove line 56:

: X
: ipython setup.cfg
: 
: [entry_points]
: oslo.config.opts =
:     openstack_dashboard = openstack_dashboard.utils.config:list_options
:     openstack_dashboard_integration_tests = openstack_dashboard.test.integration_tests.config:list_opts    <=== removed
: # We use a custom extractor to find translatable strings in AngularJS templates.
: # See http://babel.pocoo.org/docs/messages/#referencing-extraction-methods for
: # details on how this works.
: babel.extractors =
:     angular = horizon.utils.babel_extract_angular:extract_angular


** Files: *.zuul.d/tempest-and-integrated.yaml* and *.zuul.d/project.yaml*
- *horizon-integration-pytest* job
- *horizon-ui-pytest* job  
- These jobs are configured in the project's gate and check pipelines

** Update CI/CD configs: Remove integration jobs from zuul.d:
- Remove *horizon-integration-pytest* from *project.yaml*
- Remove or comment out integration job definitions in *tempest-and-integrated.yaml*

: X
: iyaml .zuul.d/project.yaml
: 
:     check:
:       jobs:
:         - horizon-selenium-headless
:         - horizon-integration-pytest                      <===
:         - horizon-ui-pytest
:         - horizon-dsvm-tempest-plugin
:         - horizon-tox-bandit-baseline
:         - horizon-tempest-plugin-ipv6
:         - horizon-dsvm-tempest-plugin-ubuntu-jammy
: 
:     gate:
:       jobs:
:         - horizon-dsvm-tempest-plugin
:         - horizon-selenium-headless
:         - horizon-integration-pytest                      <===
:         - horizon-ui-pytest
:         - horizon-tempest-plugin-ipv6
:         - horizon-dsvm-tempest-plugin-ubuntu-jammy
: 
:     experimental:
:       jobs:
:         - horizon-integration-pytest-xstatic-master        <===
:         - horizon-tox-py36-xstatic-master
:         - horizon-nodejs20-run-test-xstatic-master
:     periodic:
:       jobs:
:         - horizon-nodejs20-run-test
:         - horizon-integration-pytest                       <===

From:
: X
: iyaml ./.zuul.d/tempest-and-integrated.yaml
: 
: - job:
:     name: horizon-integration-pytest
:     parent: devstack
:     nodeset: devstack-single-node-debian-bookworm
:     pre-run: playbooks/horizon-devstack-integration/pre.yaml
:     run: playbooks/horizon-devstack-integration/run.yaml
:     post-run: playbooks/horizon-devstack-integration/post.yaml
:     roles:
:       - zuul: openstack-infra/devstack
:     required-projects:
:       - openstack/horizon
:       - openstack/requirements
:     irrelevant-files:
:       - ^.*\.rst$
:       - ^doc/.*$
:       - ^releasenotes/.*$
:       - ^.*/locale/.*$
:       # Unit tests are not related to the integration tests
:       - ^horizon/test/unit/.*$
:       - ^openstack_auth/tests/unit/.*$
:       - ^openstack_dashboard/test/unit/.*$
:       - ^openstack_dashboard/contrib/.*/tests.py$
:       - ^openstack_dashboard/dashboards/.*/tests.py$
:       # JavaScript unit tests are not related to the integration tests
:       - ^openstack_dashboard/.*/[^/]*\.spec\.js$
:       - ^horizon/static/.*/[^/]*\.spec\.js$
:     vars:
:       devstack_services:
:         horizon: true
:       tox_envlist: integration-pytest
:       tox_constraints_file: "{{ ansible_user_dir }}/{{ zuul.projects['opendev.org/openstack/requirements'].src_dir }}/upper-constraints.txt"
: 
: - job:
:     name: horizon-ui-pytest
:     parent: devstack
:     nodeset: devstack-single-node-debian-bookworm
:     pre-run: playbooks/horizon-devstack-integration/pre.yaml
:     run: playbooks/horizon-devstack-integration/run.yaml
:     post-run: playbooks/horizon-devstack-integration/post.yaml
:     roles:
:       - zuul: openstack-infra/devstack
:     required-projects:
:       - openstack/horizon
:       - openstack/requirements
:     irrelevant-files:
:       - ^.*\.rst$
:       - ^doc/.*$
:       - ^releasenotes/.*$
:       - ^.*/locale/.*$
:       # Unit tests are not related to the integration tests
:       - ^horizon/test/unit/.*$
:       - ^openstack_auth/tests/unit/.*$
:       - ^openstack_dashboard/test/unit/.*$
:       - ^openstack_dashboard/contrib/.*/tests.py$
:       - ^openstack_dashboard/dashboards/.*/tests.py$
:       # JavaScript unit tests are not related to the integration tests
:       - ^openstack_dashboard/.*/[^/]*\.spec\.js$
:       - ^horizon/static/.*/[^/]*\.spec\.js$
:     vars:
:       devstack_services:
:         horizon: true
:       tox_envlist: ui-pytest
:       tox_constraints_file: "{{ ansible_user_dir }}/{{ zuul.projects['opendev.org/openstack/requirements'].src_dir }}/upper-constraints.txt"
: 
: - job:
:     name: horizon-dsvm-tempest-plugin
:     parent: devstack-tempest
:     required-projects: &base_required_projects
:       - name: openstack/horizon
:       - name: openstack/tempest
:     irrelevant-files: &base_irrelevant_files
:       - ^.*\.rst$
:       - ^doc/.*$
:       - ^releasenotes/.*$
:       - ^.*/locale/.*$
:       # Test codes are not related to tempest tests
:       # as tempest is defined in a separete repository
:       - ^horizon/test/.*$
:       - ^openstack_auth/tests/.*$
:       - ^openstack_dashboard/test/.*$
:       - ^openstack_dashboard/contrib/.*/tests.py$
:       - ^openstack_dashboard/dashboards/.*/tests.py$
:       # JavaScript unit tests are not related to tempest tests
:       - ^openstack_dashboard/.*/[^/]*\.spec\.js$
:       - ^horizon/static/.*/[^/]*\.spec\.js$
:     vars: &base_vars
:       devstack_services:
:         horizon: true
:         tempest: true
:       tempest_concurrency: 2
:       tempest_test_regex: test_dashboard_basic_ops
:       tox_envlist: all
: 
: # TODO(gmann): As per the 2025.1 testing runtime, we need to run at least
: # one job on jammy. This job can be removed in the next cycle(2025.2)
: - job:
:     name: horizon-dsvm-tempest-plugin-ubuntu-jammy
:     description: This is integrated compute job testing on Ubuntu jammy(22.04)
:     parent: horizon-dsvm-tempest-plugin
:     nodeset: openstack-single-node-jammy
: 
: - job:
:     name: horizon-tempest-plugin-ipv6
:     parent: devstack-tempest-ipv6
:     required-projects: *base_required_projects
:     irrelevant-files: *base_irrelevant_files
:     vars: *base_vars

To:
: X
: iyaml ./.zuul.d/tempest-and-integrated.yaml
: 
: - job:
:     name: horizon-ui-pytest
:     parent: devstack
:     nodeset: devstack-single-node-debian-bookworm
:     pre-run: playbooks/horizon-devstack-integration/pre.yaml
:     run: playbooks/horizon-devstack-integration/run.yaml
:     post-run: playbooks/horizon-devstack-integration/post.yaml
:     roles:
:       - zuul: openstack-infra/devstack
:     required-projects:
:       - openstack/horizon
:       - openstack/requirements
:     irrelevant-files:
:       - ^.*\.rst$
:       - ^doc/.*$
:       - ^releasenotes/.*$
:       - ^.*/locale/.*$
:       # Unit tests are not related to the integration tests
:       - ^horizon/test/unit/.*$
:       - ^openstack_auth/tests/unit/.*$
:       - ^openstack_dashboard/test/unit/.*$
:       - ^openstack_dashboard/contrib/.*/tests.py$
:       - ^openstack_dashboard/dashboards/.*/tests.py$
:       # JavaScript unit tests are not related to the integration tests
:       - ^openstack_dashboard/.*/[^/]*\.spec\.js$
:       - ^horizon/static/.*/[^/]*\.spec\.js$
:     vars:
:       devstack_services:
:         horizon: true
:       tox_envlist: ui-pytest
:       tox_constraints_file: "{{ ansible_user_dir }}/{{ zuul.projects['opendev.org/openstack/requirements'].src_dir }}/upper-constraints.txt"
: 
: - job:
:     name: horizon-dsvm-tempest-plugin
:     parent: devstack-tempest
:     required-projects: &base_required_projects
:       - name: openstack/horizon
:       - name: openstack/tempest
:     irrelevant-files: &base_irrelevant_files
:       - ^.*\.rst$
:       - ^doc/.*$
:       - ^releasenotes/.*$
:       - ^.*/locale/.*$
:       # Test codes are not related to tempest tests
:       # as tempest is defined in a separete repository
:       - ^horizon/test/.*$
:       - ^openstack_auth/tests/.*$
:       - ^openstack_dashboard/test/.*$
:       - ^openstack_dashboard/contrib/.*/tests.py$
:       - ^openstack_dashboard/dashboards/.*/tests.py$
:       # JavaScript unit tests are not related to tempest tests
:       - ^openstack_dashboard/.*/[^/]*\.spec\.js$
:       - ^horizon/static/.*/[^/]*\.spec\.js$
:     vars: &base_vars
:       devstack_services:
:         horizon: true
:         tempest: true
:       tempest_concurrency: 2
:       tempest_test_regex: test_dashboard_basic_ops
:       tox_envlist: all
: 
: # TODO(gmann): As per the 2025.1 testing runtime, we need to run at least
: # one job on jammy. This job can be removed in the next cycle(2025.2)
: - job:
:     name: horizon-dsvm-tempest-plugin-ubuntu-jammy
:     description: This is integrated compute job testing on Ubuntu jammy(22.04)
:     parent: horizon-dsvm-tempest-plugin
:     nodeset: openstack-single-node-jammy
: 
: - job:
:     name: horizon-tempest-plugin-ipv6
:     parent: devstack-tempest-ipv6
:     required-projects: *base_required_projects
:     irrelevant-files: *base_irrelevant_files
:     vars: *base_vars

*TODO:* *QUESTION: What about these (above) references to integration?*
*DONE:* left for now

: - job:
:     name: horizon-ui-pytest
:     parent: devstack
:     nodeset: devstack-single-node-debian-bookworm
:     pre-run: playbooks/horizon-devstack-integration/pre.yaml
:     run: playbooks/horizon-devstack-integration/run.yaml
:     post-run: playbooks/horizon-devstack-integration/post.yaml
:     roles:
:       - zuul: openstack-infra/devstack
:     required-projects:
:       - openstack/horizon
:       - openstack/requirements
:     irrelevant-files:
:       - ^.*\.rst$
:       - ^doc/.*$
:       - ^releasenotes/.*$
:       - ^.*/locale/.*$
:       # Unit tests are not related to the integration tests
:       - ^horizon/test/unit/.*$
:       - ^openstack_auth/tests/unit/.*$
:       - ^openstack_dashboard/test/unit/.*$
:       - ^openstack_dashboard/contrib/.*/tests.py$
:       - ^openstack_dashboard/dashboards/.*/tests.py$
:       # JavaScript unit tests are not related to the integration tests
:       - ^openstack_dashboard/.*/[^/]*\.spec\.js$
:       - ^horizon/static/.*/[^/]*\.spec\.js$
:     vars:
:       devstack_services:
:         horizon: true
:       tox_envlist: ui-pytest
:       tox_constraints_file: "{{ ansible_user_dir }}/{{ zuul.projects['opendev.org/openstack/requirements'].src_dir }}/upper-constraints.txt"

** File: tools/unit_tests.sh
- Line 36: Excludes integration tests with tag filtering
- Line 67: Ignores selenium directory

From:
:  tag="not selenium and not integration and not plugin_test"

To:
:  tag="not selenium and not plugin_test"

*TODO:* *QUESTION: line 67: NOT SURE WHAT TO DO ABOUT THIS LINE?*
*DONE:* left it for now

: ignore="--ignore=$root/openstack_dashboard/test/selenium"

* Clean up tools/executable_files.txt: Remove non-existent gate script references
** File: tools/executable_files.txt
- References *./tools/gate/integration/post_test_hook.sh* and *./tools/gate/integration/pre_test_hook.sh* (though these files don't exist)

: X
: ishell tools/executable_files.txt
: 
: ./manage.py
: ./node_modules
: ./tools/abandon_old_reviews.sh
: ./tools/find_settings.py
: ./tools/gate/integration/post_test_hook.sh   <==
: ./tools/gate/integration/pre_test_hook.sh    <==
: ./tools/list-horizon-plugins.py
: ./tools/unit_tests.sh
: ./tools/selenium_tests.sh


** Settings and Template Conditional Logic
These are *safe to leave as-is* because they use conditional checks:

: X
: ishell openstack_dashboard/templates/horizon/_scripts.html
: 
: {% if HORIZON_CONFIG.integration_tests_support %}                           <=== where is integration_tests_support defined?
: <script src="{{ STATIC_URL }}horizon/js/horizon.selenium.js"></script>
: {% endif %}

** File: horizon/tables/base.py

: X
: ipython horizon/tables/base.py
: 
:     if settings.INTEGRATION_TESTS_SUPPORT:
:         def get_default_attrs(self):
:             attrs = super().get_default_attrs()
:             attrs.update({'data-selenium': self.name})
:             return attrs

* Documentation and Release Notes
These are informational and won't break functionality.
- Various translation files and release notes mentioning integration tests  <===
- Documentation in *doc/source/contributor/topics/testing.rst*              <===

: X
: ishell doc/source/contributor/topics/testing.rst
: 
: Integration Tests
: -----------------
: 
: This layer of testing involves testing all of the components that your
: codebase interacts with or relies on in conjunction. This is equivalent to
: "live" testing, but in a repeatable manner.
: 
: Pros:
: 
: * Catches *many* bugs that unit and functional tests will not.
: * Doesn't rely on assumptions about the inputs and outputs.
: * Will warn you when changes in external components break your code.
: * Will take screenshot of the current page on test fail for easy debug
: 
: Cons:
: 
: * Difficult and time-consuming to create a repeatable test environment.
: * Did I mention that setting it up is a pain?
: 
: Screenshot directory could be set through horizon.conf file, default value:
: ``./integration_tests_screenshots``

* Testing the Removal
After removal, test these commands to ensure nothing breaks:

Should still work
- tox -e pep8
- tox -e py3
- tox -e npm
- tox -e selenium

Should fail gracefully or be removed

: tox -e integration  # Remove this environment
: tox -e integration-pytest  # Remove this environment
: tox -e ui-pytest  # Remove this environment

Should work
: oslo-config-generator --namespace openstack_dashboard  # Remove integration_tests namespace

* latest sequence

: git clone https://opendev.org/openstack/horizon.git horizon-osprh_18672
: cd horizon-osprh_18672
: git remote add gerrit ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git
: git review -s

: [omcgonag@omcgonag-thinkpadp16vgen1 horizon-osprh_18672]$ git status
: On branch master
: Your branch is up to date with 'origin/master'.
: 
: Changes not staged for commit:
:   (use "git add/rm <file>..." to update what will be committed)
:   (use "git restore <file>..." to discard changes in working directory)
: 	modified:   .zuul.d/project.yaml
: 	modified:   .zuul.d/tempest-and-integrated.yaml
: 	modified:   doc/source/contributor/topics/testing.rst
: 	deleted:    openstack_dashboard/test/integration_tests/README.rst
: 	deleted:    openstack_dashboard/test/integration_tests/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/basewebobject.py
: 	deleted:    openstack_dashboard/test/integration_tests/config.py
: 	deleted:    openstack_dashboard/test/integration_tests/decorators.py
: 	deleted:    openstack_dashboard/test/integration_tests/helpers.py
: 	deleted:    openstack_dashboard/test/integration_tests/horizon.conf
: 	deleted:    openstack_dashboard/test/integration_tests/pages/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/compute/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/compute/flavorspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/compute/hostaggregatespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/compute/hypervisorspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/compute/imagespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/compute/instancespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/network/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/network/floatingipspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/network/networkspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/network/routerspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/overviewpage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/system/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/system/defaultspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/system/imagespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/system/metadatadefinitionspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/system/resource_usage/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/system/system_info/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/volume/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/volume/grouptypespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/volume/snapshotspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/volume/volumespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/admin/volume/volumetypespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/basepage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/identity/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/identity/groupspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/identity/projectspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/identity/rolespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/identity/userspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/loginpage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/navigation.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/pageobject.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/apiaccesspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/compute/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/compute/imagespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/compute/instancespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/compute/keypairspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/compute/overviewpage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/compute/servergroupspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/floatingipspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/networkoverviewpage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/networkspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/networktopologypage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/routerinterfacespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/routeroverviewpage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/routerspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/security_groups/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/security_groups/managerulespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/network/securitygroupspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/object_store/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/volumes/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/volumes/snapshotspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/project/volumes/volumespage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/settings/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/settings/changepasswordpage.py
: 	deleted:    openstack_dashboard/test/integration_tests/pages/settings/usersettingspage.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/bars.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/baseregion.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/exceptions.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/forms.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/menus.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/messages.py
: 	deleted:    openstack_dashboard/test/integration_tests/regions/tables.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/__init__.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test-data/empty_namespace.json
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_credentials.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_defaults.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_flavors.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_floatingips.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_groups.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_grouptypes.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_host_aggregates.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_images.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_instances.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_keypairs.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_login.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_metadata_definitions.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_networks.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_projects.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_router.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_router_gateway.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_security_groups.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_user_settings.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_users.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_volume_snapshots.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_volumes.py
: 	deleted:    openstack_dashboard/test/integration_tests/tests/test_volumetypes.py
: 	deleted:    openstack_dashboard/test/integration_tests/video_recorder.py
: 	deleted:    openstack_dashboard/test/selenium/integration/conftest.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_credentials.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_defaults.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_federation_login.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_flavors.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_floatingips.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_groups.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_grouptypes.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_host_aggregates.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_images.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_instances.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_keypairs.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_metadata_definitions.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_networks.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_projects.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_routers.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_security_groups.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_settings.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_user_credentials.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_users.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_volume_snapshots.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_volumes.py
: 	deleted:    openstack_dashboard/test/selenium/integration/test_volumetypes.py
: 	modified:   tools/executable_files.txt
: 	modified:   tools/unit_tests.sh
: 	modified:   tox.ini
: 
: no changes added to commit (use "git add" and/or "git commit -a")

: git config core.editor "emacsclient"
: export EDITOR=emacsclient
: M-x server-start

: git add .
: git commit

COMMIT MSG: 
: Remove all dependencies/connections of old integration test code

* latest again
Ok, back to start... still getting this!

: git clone https://opendev.org/openstack/horizon.git horizon-osprh_18672
: cd horizon-osprh_18672
: git remote add gerrit ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git
: git review -s

** Problem running 'git remote update gerrit'

ask: 

: Problem running 'git remote update gerrit'
: Fetching gerrit
: omcgonag@review.opendev.org: Permission denied (publickey).
: fatal: Could not read from remote repository.
: 
: Please make sure you have the correct access rights
: and the repository exists.
: error: could not fetch gerrit
: 
: The following command failed with exit code 1
:     "scp -O -P29418 omcgonag@review.opendev.org:hooks/commit-msg .git/hooks/commit-msg"
: -----------------------
: omcgonag@review.opendev.org: Permission denied (publickey).
: -----------------------

Thanks for walking me through the exact steps you ran — this is definitely a **pure SSH key issue** now. 
Your Git remote is correct (`ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git`). Gerrit is just refusing your authentication.

Here’s how to nail it down:

** Check what SSH key you’re offering
: ssh -vv -p 29418 omcgonag@review.opendev.org

Do you see any `Offering public key` lines? Which one?
At the end you’ll see either:

* `Authentication succeeded (publickey)` ✅
* or `Permission denied (publickey)` ❌

Scroll through the debug log and look for:
: Offering public key: /home/omcgonag/.ssh/id_ed25519
: Offering public key: /home/omcgonag/.ssh/id_rsa

I see:
: debug1: Offering public key: /home/omcgonag/.ssh/id_rsa RSA SHA256:Bsp65JoufeEdug7c6nMnr8ZUpyzj0gnWIL3UC9Hsng0 explicit
: debug2: we sent a publickey packet, wait for reply
: debug1: Authentications that can continue: publickey
: debug2: we did not send a packet, disable method
: debug1: No more authentication methods to try.
: omcgonag@review.opendev.org: Permission denied (publickey).

** Verify your key is uploaded to Gerrit
Check in Gerrit web UI [[https://review.opendev.org/settings/#SSHKeys][https://review.opendev.org/settings/#SSHKeys]]

Make sure the *same public key* you saw in step 1 is listed there.

If not, add it - copy-paste into Gerrit
: cat /home/omcgonag/.ssh/id_rsa.pub

** Force Gerrit to use the right key
If multiple keys exist, SSH might be offering the wrong one.

Add this to `~/.ssh/config`:

: Host review.opendev.org
:     User omcgonag
:     Port 29418
:     IdentityFile ~/.ssh/id_rsa
:     IdentitiesOnly yes

Test again: you should see the Gerrit welcome banner if it works.
: ssh review.opendev.org

*FINALLY* I see it working!
: [omcgonag@omcgonag-thinkpadp16vgen1 horizon-osprh_18672]$ ssh review.opendev.org
: 
:   ****    Welcome to Gerrit Code Review    ****
: 
:   Hi Owen McGonagle, you have successfully connected over SSH.
: 
:   Unfortunately, interactive shells are disabled.
:   To clone a hosted Git repository, use:
: 
:   git clone ssh://omcgonag@review.opendev.org:29418/REPOSITORY_NAME.git
: 
: Connection to review.opendev.org closed.

** Retry git-review
Once *ssh review.opendev.org* works, this will succeed:

** I see it working!
: git review -s
: git review

* full sequence

: $ git status
: On branch master
: Your branch is ahead of 'origin/master' by 1 commit.
:   (use "git push" to publish your local commits)
: 
: nothing to commit, working tree clean

: $ git add .
: $ git commit
: <I ENTERED MY COMMIT_MSG>

: $ git review -s
: $ git review
: remote: 
: remote: Processing changes: refs: 1        
: remote: Processing changes: refs: 1, done            
: To ssh://review.opendev.org:29418/openstack/horizon.git
:  ! [remote rejected]     HEAD -> refs/for/master (commit 280a262: not Signed-off-by author/committer/uploader in message footer)
: error: failed to push some refs to 'ssh://review.opendev.org:29418/openstack/horizon.git'

Add signature
: $ git commit --amend -s

: $ git review
: remote: 
: remote: Processing changes: new: 1 (\)        
: remote: Processing changes: refs: 1, new: 1 (\)        
: remote: Processing changes: refs: 1, new: 1, done            
: remote: commit c0e05bf: warning: subject >50 characters; use shorter first paragraph        
: remote: 
: remote: SUCCESS        
: remote: 
: remote:   https://review.opendev.org/c/openstack/horizon/+/960204 Remove all dependencies/connections of old integration test code [NEW]        
: remote: 
: To ssh://review.opendev.org:29418/openstack/horizon.git
:  * [new reference]       HEAD -> refs/for/master


* Nice — you’re very close now 🎉
The push to Gerrit worked, but it **rejected the commit** because it’s missing a required footer:
: commit 280a262: not Signed-off-by author/committer/uploader in message footer

That means your commit message doesn’t have a `Signed-off-by:` line.

** ✅ Fix: Add Signed-off-by line
You can add it manually or use Git’s built-in helper.

** Option 1: Amend commit with sign-off
: git commit --amend -s

This will add a line at the end of your commit message like:

: Signed-off-by: Owen McGonagle <omcgonag@redhat.com>

Save & quit the editor.

Then push again:

: git review

** Option 2: Add manually
If you prefer, just edit your commit message:

: git commit --amend

and at the bottom, add:

: Signed-off-by: Owen McGonagle <your.email@example.com>

Then retry:
: git review

** ⚡ Tip for the future

If you always want Git to add this line automatically, set:

: git config --global commit.gpgsign false
: git config --global user.name "Owen McGonagle"
: git config --global user.email "your.email@example.com"
: git config --global format.signoff true
```
That way every new commit will include the `Signed-off-by:` footer automatically.

👉 Do you want me to show you how to **set your Gerrit preferred email** too, so the `Signed-off-by` matches what Gerrit expects?

ask: yes

Perfect 👍 — Gerrit is picky: the email in your commit footer (`Signed-off-by`) must match an email registered in your Gerrit account. If they don’t match, you’ll keep seeing rejections.

** 🔎 Step 1: Check what Gerrit knows about you
- Log into [[https://review.opendev.org/][https://review.opendev.org/]]
- Click your avatar -> Settings
- Go to *Contact Information* -> *Emails*

Make sure your preferred email (the one with the star ⭐) is the one you want to use.

** 🔎 Step 2: Check your Git config

Run:
: git config user.name
: git config user.email

Example output:
: Owen McGonagle
: omcgonag@redhat.com

** 🔧 Step 3: Fix mismatch if needed
If the Gerrit email ≠ Git email, set them to match:
: git config --global user.name "Owen McGonagle"
: git config --global user.email "omcgonag@redhat.com"

You can also set per-repo if you don’t want to change globally:
: git config user.email "omcgonag@redhat.com"


** 🔄 Step 4: Amend your commit
Once fixed, amend your last commit with the right Signed-off-by:
: git commit --amend -s

Then push again:
: git review

✨ That should clear the `not Signed-off-by` error.

Do you want me to show you how to **make Git always include the correct Signed-off-by footer automatically** (so you never need to amend manually again)?
: ask: no

* Misc: second change sequence

: ask: 
: 
: My first sequence (first review) was:
: 
: : git remote add gerrit ssh://omcgonag@review.opendev.org:29418/openstack/horizon.git
: : git review -s
: : git add .
: : git commit
: : git review
: 
: Is this the correct sequecne for the next change(s)?
: 
: git add .
: git commit --amend
: git review

Yes — for subsequent changes to an **existing Gerrit review**, your sequence is slightly different because the Gerrit remote is already set up and you already have the commit-msg hook. 
Here’s the proper workflow:

** 🔹 Workflow for next change(s)

- **Make your changes** in the working tree.
- **Stage the changes**
: git add .

** *Amend the previous commit*
This updates the same change so Gerrit treats it as a new **patch set** rather than a new review.
: git commit --amend -s

: `-s` ensures the `Signed-off-by:` footer is correct.
: Update the commit message if needed (leave Change-Id line untouched — Gerrit uses it to track patch sets).

** Push to Gerrit
This will push the amended commit to the *same review*, creating a new patch set.
: git review

*NOTES:
- Do **not** use *git commit* (normal) for an update, or Gerrit will treat it as a new change. Always use *--amend* for updates to an existing review.
- The *git review -s* step is **only needed the first time** to set up the remote and commit-msg hook.

So your proposed sequence for the next change is correct:
: git add .
: git commit --amend -s
: git review

* Misc: yes
If you want, I can also summarize a **full “first-time + subsequent changes” workflow** in one clean table for Gerrit. This makes it easy to remember. Do you want me to do that?
: ask: yes
